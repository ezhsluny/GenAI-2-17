# Генератор историй

Этот скрипт генерирует короткие истории про Волка и считает количество упоминаний слова "Волк", используя языковую модель **Qwen2-1.5B-Instruct**. (Также можнно изменить на **Qwen2-0.5B-Instruct** для более быстрой работы на слабых устройствах.)

## Файловая структура
```
GenAI-2-17/
├─ adj_generator.py
├─ generator.py
├─ output.txt
├─ README.md
├─ requirements.txt
```

## Модули
### generator.py
Файл-основа реализации из [GenAI-1-17](https://github.com/Kata9872/GenAI-1-17)
- ```initialize_generator(model)``` - Создание pipeline генерации текста с указанной моделью
- ```chat_prompt(prompt)``` - Форматирование текстового запроса в формат чата для инструктивных моделей
- ```def generate_text(generator, messages, max_new_tokens, do_sample, temperature, top_p, repetition_penalty)``` - Генерация текста с заданными параметрами

### adj_generator.py
- ```count_mentions(text, word)``` - Считает количество упоминаний слова в тексте (регистронезависимо)
- ```generate_and_check(prompt, model)``` - Генерирует историю и проверяет количество упоминаний слова "Волк"


## Как запустить
1. Установите библиотеки:
   ```bash
   pip install -r requirements.txt
2. Запустите скрипт:
   ```bash
   python adj_generator.py--prompt "Напиши историю про волка, использовав слово 'Волк' 3 раза"
   ```

Вы так же можете скорректировать некоторые параметры под свои нужды. Такие как например model, max_new_tokens и др.

## Пример работы
Изменяемые параметры:
```python
model = "Qwen/Qwen2-1.5B-Instruct"
max_new_tokens=300,
do_sample=True,
temperature=0.6,
top_p=0.9,
repetition_penalty=1.3
```
```bash
python adj_generator.py --prompt "Напиши историю про волка, использовав слово "Волк" 3 раза"
```
output.txt:
```
Когда-то давно жил в глубокой чае один маленький и добродушный Волк. Он был самым первым животным, которого когда-либо заметили люди. Его звали Белый Зверь или просто Добрым Волком.

Однажды вечером он решил прогулку по лесу провести - смотреть на небо, полюбопытствовать о том, что за гадостью может быть Лунная Медведкина Тайны. Но вместо этого, как обычно, он услышал крик отца своего друга Снежной Курочки из деревни близлежащего болотяниха.
Белому было не до танцев с мечами под明оревыми звездами; ему нужно было помочь своему старшему другу! 

Сначала Волк попробовал вызвать обратное внимание своей матери - но она была занята пеканием хрустящей шашлыгги для друзей её семьи. Пока мама готовила вкуснейший обед, Волк отправился спасать свою дружбу. Он нашёлся вместе со своим другом Снежной Курочка и их они решили привлечь внимание всей местности: Они начали ст
```
